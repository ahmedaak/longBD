# print ES descriptive stats ( ? also include N)
roi_es_allsubs_recan <- as.numeric(roi_es_allsubs_recan[-1,])
allrois_names_recan <- c(allrois_names_recan, x)
allrois_es_allsubs_recan <- cbind(allrois_es_allsubs_recan, roi_es_allsubs_recan)
colnames(allrois_es_allsubs_recan) <- allrois_names_recan
print(summary(roi_es_allsubs_recan))
print(paste("n=",length(roi_es_allsubs_recan)))
}
# plot separately FOR PAPER - VS
allrois_es_allsubs_recan_long_VS <- melt(allrois_es_allsubs_recan[,1:3], id.vars =allrois_names_recan)
boxplot(value ~ Var2, data = allrois_es_allsubs_recan_long_VS, cex.axis = 0.7, outline = F, xaxt = "n", main = "BOLD delay VS Recanalizers", ylim = c(-0.5, 0.7), xlab = "ROI", ylab = "Effect size", yaxt = "n")
stripchart(value ~ Var2, vertical = TRUE, data = allrois_es_allsubs_recan_long_VS, method = "jitter", add = TRUE, pch = 20, col = 'blue', cex = 1.5)
axis(side = 1, labels = c("D0 DWI lesion", "Infarct growth", "Rest of VT"), at = c(1,2,3))
axis(side = 2, cex.axis = 1.3)
abline(h=0, lty = 2)
# plot separately FOR PAPER - HH
allrois_es_allsubs_recan_long_HH <- melt(allrois_es_allsubs_recan[,4:6], id.vars =allrois_names_recan)
boxplot(value ~ Var2, data = allrois_es_allsubs_recan_long_HH, cex.axis = 0.7, outline = F, xaxt = "n", main = "BOLD delay HH Recanalizers", ylim = c(-0.5, 0.7), xlab = "ROI", ylab = "Effect size", yaxt = "n")
stripchart(value ~ Var2, vertical = TRUE, data = allrois_es_allsubs_recan_long_HH, method = "jitter", add = TRUE, pch = 20, col = 'blue', cex = 1.5)
axis(side = 1, labels = c("D0 DWI lesion", "Infarct growth", "Rest of VT"), at = c(1,2,3))
axis(side = 2, cex.axis = 1.3)
abline(h=0, lty = 2)
library(markdown)
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC.mat",sep=""))
BD_HH_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC_HH.mat",sep=""))
Tmax <- readMat(paste(data_path,"allvars_Tmax.mat",sep=""))
# Define list of perfusion maps
perfusion_list <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
par(mfrow=c(3,2),oma=c(0,2,0,0))
# create subplot labels
sp_lab = matrix(data=c("A","B","C","D","E","F"), nrow = 3, ncol = 2)
perfusion_matrix <- cbind(perfusion_list,sp_lab)
for (i in perfusion_list) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
perfusion_matrix
perfusion_matrix[perfusion_list=="BD_VS_nonegs_DSC",2]
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC.mat",sep=""))
BD_HH_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC_HH.mat",sep=""))
Tmax <- readMat(paste(data_path,"allvars_Tmax.mat",sep=""))
# Define list of perfusion maps
perfusion_names <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
# create subplot labels
subplot_labels = matrix(data=c("A","B","C","D","E","F"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix <- cbind(perfusion_names,subplot_labels)
par(mfrow=c(3,2),oma=c(0,2,0,0))
for (i in perfusion_matrix[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC.mat",sep=""))
BD_HH_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC_HH.mat",sep=""))
Tmax <- readMat(paste(data_path,"allvars_Tmax.mat",sep=""))
# Define list of perfusion maps
perfusion_names <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
# create subplot labels
subplot_labels = matrix(data=c("A","B","C","D","E","F"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix <- cbind(perfusion_names,subplot_labels)
par(mfrow=c(3,2),oma=c(0,2,0,0))
for (i in perfusion_matrix[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
i
v
i
mtext(text = perfusion_matrix[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC.mat",sep=""))
BD_HH_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC_HH.mat",sep=""))
Tmax <- readMat(paste(data_path,"allvars_Tmax.mat",sep=""))
# Define list of perfusion maps
perfusion_names <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
# create subplot labels
subplot_labels = matrix(data=c("A","B","C","D","E","F"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix <- cbind(perfusion_names,subplot_labels)
par(mfrow=c(3,2),oma=c(0,2,0,0))
for (i in perfusion_matrix[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,3], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
# Load in perfusion values
BD_VS_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs.mat",sep=""))
BD_HH_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_HH.mat",sep=""))
# Define list of perfusion maps
perfusion_names_ws <- c("BD_VS_nonegs_all","BD_HH_nonegs_all")
# create subplot labels
subplot_labels = matrix(data=c("A","C","B","D"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix_ws <- cbind(perfusion_names_ws,subplot_labels)
par(mfrow=c(2,2),oma=c(0,2,0,0))
for (i in perfusion_matrix_ws[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds")
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds")
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
# Load in perfusion values
BD_VS_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs.mat",sep=""))
BD_HH_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_HH.mat",sep=""))
# Define list of perfusion maps
perfusion_names_ws <- c("BD_VS_nonegs_all","BD_HH_nonegs_all")
# create subplot labels
subplot_labels = matrix(data=c("A","C","B","D"), nrow = 2, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix_ws <- cbind(perfusion_names_ws,subplot_labels)
par(mfrow=c(2,2),oma=c(0,2,0,0))
for (i in perfusion_matrix_ws[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds")
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds")
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
# Load in perfusion values
BD_VS_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs.mat",sep=""))
BD_HH_nonegs_all <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_HH.mat",sep=""))
# Define list of perfusion maps
perfusion_names_ws <- c("BD_VS_nonegs_all","BD_HH_nonegs_all")
# create subplot labels
subplot_labels = matrix(data=c("A","C","B","D"), nrow = 2, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix_ws <- cbind(perfusion_names_ws,subplot_labels)
par(mfrow=c(2,2),oma=c(0,2,0,0))
for (i in perfusion_matrix_ws[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds")
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds")
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
subplot_labels
perfusion_matrix_ws
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC.mat",sep=""))
BD_HH_nonegs_DSC <- readMat(paste(data_path,"allvars_BOLD_delay_nonegs_subswithDSC_HH.mat",sep=""))
Tmax <- readMat(paste(data_path,"allvars_Tmax.mat",sep=""))
# Define list of perfusion maps
perfusion_names <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
# create subplot labels
subplot_labels = matrix(data=c("A","C","E","B","D","F"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix <- cbind(perfusion_names,subplot_labels)
par(mfrow=c(3,2),oma=c(0,2,0,0))
for (i in perfusion_matrix[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axes=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,3], side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
volumes_data
?oma
?par
# Load in perfusion values
BD_VS_nonegs_DSC <- readMat("allvars_BOLD_delay_nonegs_subswithDSC.mat")
BD_HH_nonegs_DSC <- readMat("allvars_BOLD_delay_nonegs_subswithDSC_HH.mat")
Tmax <- readMat("allvars_Tmax.mat")
# Define list of perfusion maps
perfusion_names <- c("BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax")
# create subplot labels
subplot_labels = matrix(data=c("A","B","C","D","E","F"), nrow = 3, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix <- cbind(perfusion_names,subplot_labels)
#par(mfrow=c(3,2),oma=c(0,2,0,0))
par(mfcol=c(2,3),oma=c(2,2,0,0))
for (i in perfusion_matrix[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
# Plot non-recanalizers
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axis=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,2], side = 3, line = 0.5, adj = -0.2, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
# Plot recanalizers
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds",cex.lab=1.5,cex.axis=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix[perfusion_names==i,3], side = 3, line = 0.5, adj = -0.2, font = 2, cex=1.5)
# add mean lines
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
}
mtext("Day 0", col = "blue", outer = T, side = 1, line = 1, adj=0.475)
mtext("Day 1", col = "red", outer = T, side = 1, line = 1, adj=0.535)
# Load in perfusion values
BD_VS_nonegs_all <- readMat("allvars_BOLD_delay_nonegs.mat")
BD_HH_nonegs_all <- readMat("allvars_BOLD_delay_nonegs_HH.mat")
# Define list of perfusion maps
perfusion_names_ws <- c("BD_VS_nonegs_all","BD_HH_nonegs_all")
# create subplot labels
subplot_labels = matrix(data=c("A","C","B","D"), nrow = 2, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix_ws <- cbind(perfusion_names_ws,subplot_labels)
par(mfrow=c(2,2),oma=c(2,2,0,0))
for (i in perfusion_matrix_ws[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axis=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,2], side = 3, line = 0.5, adj = -0.25, font = 2, cex=1.5)
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axis=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,3], side = 3, line = 0.5, adj = -0.25, font = 2, cex=1.5)
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
# Test for significance between D0+D1 BOLD delay severity change + calculate effect size
#vt_D0_D1_sig <- wilcoxsign_test(v$nonrecan.vals.d0)
}
mtext("Day 0", col = "blue", outer = T, side = 1, line = 0.7, adj=0.45, cex=1.2)
mtext("Day 1", col = "red", outer = T, side = 1, line = 0.7, adj=0.55, cex=1.2)
v
v$nonrecan.vals.d0
# Load in perfusion values
BD_VS_nonegs_all <- readMat("allvars_BOLD_delay_nonegs.mat")
BD_HH_nonegs_all <- readMat("allvars_BOLD_delay_nonegs_HH.mat")
# Define list of perfusion maps
perfusion_names_ws <- c("BD_VS_nonegs_all","BD_HH_nonegs_all")
# create subplot labels
subplot_labels = matrix(data=c("A","C","B","D"), nrow = 2, ncol = 2)
# concatenate names of perfusion maps with subplot labels
perfusion_matrix_ws <- cbind(perfusion_names_ws,subplot_labels)
par(mfrow=c(2,2),oma=c(2,2,0,0))
for (i in perfusion_matrix_ws[,1]) {
# calculate kernel densities for voxelwise BOLD delay values in entire VTs
v = get(i)
d0_nonrecan <- density(v$nonrecan.vals.d0, bw = 1)
d1_nonrecan <- density(v$nonrecan.vals.d1, bw = 1)
d0_recan <- density(v$recan.vals.d0, bw = 1)
d1_recan <- density(v$recan.vals.d1, bw = 1)
## KERNEL DENSITY PLOTS
# create transparent fill colours
redtrans <- rgb(255, 0, 0, 75, maxColorValue=255)
bluetrans <- rgb(0, 0, 255, 75, maxColorValue=255)
plot(d1_nonrecan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "non-recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axis=1.5)
polygon(d1_nonrecan, col = redtrans, border = "red")
lines(d0_nonrecan, col = "blue", lwd = 3)
polygon(d0_nonrecan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,2], side = 3, line = 0.5, adj = -0.25, font = 2, cex=1.5)
abline(v = mean(v$nonrecan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$nonrecan.vals.d1), col = "red", lty = 3, lwd = 3)
plot(d1_recan, col = "red", xlim=(c(0,20)), ylim=c(0,max(d0_nonrecan$y, d1_nonrecan$y, d0_recan$y, d1_recan$y)), main = paste(i, "recan"), lwd = 3, xlab = "Seconds", cex.lab=1.5,cex.axis=1.5)
polygon(d1_recan, col = redtrans, border = "red")
lines(d0_recan, col = "blue", lwd = 3)
polygon(d0_recan, col = bluetrans, border = "blue")
# add subplot labels
mtext(text = perfusion_matrix_ws[perfusion_names_ws==i,3], side = 3, line = 0.5, adj = -0.25, font = 2, cex=1.5)
abline(v = mean(v$recan.vals.d0), col = "blue", lty = 3, lwd = 3)
abline(v = mean(v$recan.vals.d1), col = "red", lty = 3, lwd = 3)
# Test for significance between D0+D1 BOLD delay severity change + calculate effect size
vt_D0_D1_nonrecan_sig <- wilcoxsign_test(v$nonrecan.vals.d0~v$nonrecan.vals.d1, paired=T)
}
mtext("Day 0", col = "blue", outer = T, side = 1, line = 0.7, adj=0.45, cex=1.2)
mtext("Day 1", col = "red", outer = T, side = 1, line = 0.7, adj=0.55, cex=1.2)
library(pkgc)
library(pkg)
install.packages("pkg")
library(pkg)
install.packages("pkg")
?wilcox.test
vt_D0_D1_nonrecan_sig <- wilcox.test(v$nonrecan.vals.d0~v$nonrecan.vals.d1, paired=T)
length(v$nonrecan.vals.d0)
length(v$nonrecan.vals.d1)
length(v$recan.vals.d1)
length(v$recan.vals.d0)
vt_D0_D1_nonrecan_sig <- wilcox.test(v$nonrecan.vals.d0~v$nonrecan.vals.d1, paired=F)
install.packages("pwr")
install.packages("pwr")
install.packages("pwr")
library(pwr)
pwr.r.test(r=0.15,sig.level = 0.5,power = 0.2)
pwr.r.test(r=0.15,sig.level=0.5,power =0.2)
?pwr.r.test
pwr.r.test(r=0.15,sig.level=0.05,power =0.2)
pwr.r.test(r=0.2,sig.level=0.05,power =0.2)
library(pwr)
pwr.r.test(n=25, sig.level = 0.05, r=0.6)
pwr.r.test(n=25, sig.level = 0.05, r=0.4)
pwr.r.test(n=25, sig.level = 0.05, r=0.5)
pwr.r.test(n=25, sig.level = 0.05, r=0.44)
pwr.r.test(n=25, sig.level = 0.05, r=0.41)
library(AnalyzeFMRI)
fastICA()
?fastICA()
