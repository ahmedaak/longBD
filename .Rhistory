boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,120), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Ratios. NB: the BOLD delay ratios here are ONLY for subjects who have both BD + Tmax (for comparison purposes)
boxplot(volumes_data[volumes_data$recan=="No" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, at=c(1),xlim=c(0,6),ylim=c(0,2.5), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, add=T,at=c(2), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="No",]$Tmax_ratio_man, add=T, at=c(4),xlim=c(0,6),ylim=c(0,2), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes",]$Tmax_ratio_man, add=T,at=c(5), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
# add horizontal dashed line at ratio = 1
abline(h=1.0, lty=2)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("BOLD delay","Tmax"), cex.axis=1.5)
# add legend
legend("topright", legend = c("Non-recanalizers","Recanalizers"), fill=c("white","grey"),cex = 1.5)
title("Ratios",cex.main=1.5)
mtext(text = "D", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# PRE/POST PLOTS of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# DWI volumes PRE/POST PLOTS
DWI_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$DWI_D0,volumes_data[volumes_data$recan=="Yes",]$DWI_D1)
DWI_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$DWI_D0,volumes_data[volumes_data$recan=="No",]$DWI_D1)
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(DWI_recan_matrix,DWI_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(DWI_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(DWI_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay
BD_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$TSA_D0_man,volumes_data[volumes_data$recan=="Yes",]$TSA_D1_man)
BD_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$TSA_D0_man,volumes_data[volumes_data$recan=="No",]$TSA_D1_man)
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(BD_recan_matrix,BD_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
matplot(x=c(1,2),y=t(BD_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(BD_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
Tmax_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$Tmax_D0_man,volumes_data[volumes_data$recan=="Yes",]$Tmax_D1_man)
Tmax_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$Tmax_D0_man,volumes_data[volumes_data$recan=="No",]$Tmax_D1_man)
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,120), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(Tmax_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(Tmax_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# load data table with all the volumes
volumes_data <- read.csv2(file="volumes.csv", header = T, na.strings = "NaN", stringsAsFactors = F, sep = ";", dec = ".")
# remove column with subject numbers
volumes_data <- volumes_data[,c(2:18)]
# add columns for binary recanalization status + TIMI score + whether or not they had a DSC scan as well
volumes_data$recan <- c("No", "No", "No", "Yes", "No", "No", "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", "No")
volumes_data$TIMI <- c(0, 0, 0, 2, 0, 0, 3, 1, 2, 0, 3, 3, 3, 0, 1)
volumes_data$DSC <- c("Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","Yes","No","No","No")
# calculate agreement (ICC) between manual + auto delineation ratios - see section below with "agreement between ..."
# BOLD delay ratios
r3 <- icc(volumes_data[,c(6,12)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r3$comparison <- "BOLD delay ratios manual vs auto"
# Tmax ratios
r6 <- icc(volumes_data[,c(9,15)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r6$comparison <- "Tmax ratios manual vs auto"
agr_list_all <- list(r3,r6)
# boxplots of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# define D0 and D1 colors
D0_col <- rgb(0,0,1,alpha = 0.3)
D1_col <- rgb(1,0,0,alpha = 0.3)
# DWI volumes BOXPLOTS
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,50), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay volumes
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,170), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,120), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Ratios. NB: the BOLD delay ratios here are ONLY for subjects who have both BD + Tmax (for comparison purposes)
boxplot(volumes_data[volumes_data$recan=="No" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, at=c(1),xlim=c(0,6),ylim=c(0,2.5), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, add=T,at=c(2), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="No",]$Tmax_ratio_man, add=T, at=c(4),xlim=c(0,6),ylim=c(0,2), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes",]$Tmax_ratio_man, add=T,at=c(5), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
# add horizontal dashed line at ratio = 1
abline(h=1.0, lty=2)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("BOLD delay","Tmax"), cex.axis=1.5)
# add legend
legend("topright", legend = c("Non-recanalizers","Recanalizers"), fill=c("white","grey"),cex = 1.5)
title("Ratios",cex.main=1.5)
mtext(text = "D", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# PRE/POST PLOTS of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# DWI volumes PRE/POST PLOTS
DWI_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$DWI_D0,volumes_data[volumes_data$recan=="Yes",]$DWI_D1)
DWI_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$DWI_D0,volumes_data[volumes_data$recan=="No",]$DWI_D1)
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(DWI_recan_matrix,DWI_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(DWI_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(DWI_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay
BD_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$TSA_D0_man,volumes_data[volumes_data$recan=="Yes",]$TSA_D1_man)
BD_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$TSA_D0_man,volumes_data[volumes_data$recan=="No",]$TSA_D1_man)
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(BD_recan_matrix,BD_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
matplot(x=c(1,2),y=t(BD_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(BD_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
Tmax_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$Tmax_D0_man,volumes_data[volumes_data$recan=="Yes",]$Tmax_D1_man)
Tmax_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$Tmax_D0_man,volumes_data[volumes_data$recan=="No",]$Tmax_D1_man)
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),c(0,max(Tmax_recan_matrix,Tmax_nonrecan_matrix)), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(Tmax_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(Tmax_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# load data table with all the volumes
volumes_data <- read.csv2(file="volumes.csv", header = T, na.strings = "NaN", stringsAsFactors = F, sep = ";", dec = ".")
# remove column with subject numbers
volumes_data <- volumes_data[,c(2:18)]
# add columns for binary recanalization status + TIMI score + whether or not they had a DSC scan as well
volumes_data$recan <- c("No", "No", "No", "Yes", "No", "No", "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", "No")
volumes_data$TIMI <- c(0, 0, 0, 2, 0, 0, 3, 1, 2, 0, 3, 3, 3, 0, 1)
volumes_data$DSC <- c("Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","Yes","No","No","No")
# calculate agreement (ICC) between manual + auto delineation ratios - see section below with "agreement between ..."
# BOLD delay ratios
r3 <- icc(volumes_data[,c(6,12)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r3$comparison <- "BOLD delay ratios manual vs auto"
# Tmax ratios
r6 <- icc(volumes_data[,c(9,15)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r6$comparison <- "Tmax ratios manual vs auto"
agr_list_all <- list(r3,r6)
# boxplots of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# define D0 and D1 colors
D0_col <- rgb(0,0,1,alpha = 0.3)
D1_col <- rgb(1,0,0,alpha = 0.3)
# DWI volumes BOXPLOTS
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,50), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay volumes
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,170), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,120), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Ratios. NB: the BOLD delay ratios here are ONLY for subjects who have both BD + Tmax (for comparison purposes)
boxplot(volumes_data[volumes_data$recan=="No" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, at=c(1),xlim=c(0,6),ylim=c(0,2.5), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, add=T,at=c(2), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="No",]$Tmax_ratio_man, add=T, at=c(4),xlim=c(0,6),ylim=c(0,2), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes",]$Tmax_ratio_man, add=T,at=c(5), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
# add horizontal dashed line at ratio = 1
abline(h=1.0, lty=2)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("BOLD delay","Tmax"), cex.axis=1.5)
# add legend
legend("topright", legend = c("Non-recanalizers","Recanalizers"), fill=c("white","grey"),cex = 1.5)
title("Ratios",cex.main=1.5)
mtext(text = "D", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# PRE/POST PLOTS of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# DWI volumes PRE/POST PLOTS
DWI_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$DWI_D0,volumes_data[volumes_data$recan=="Yes",]$DWI_D1)
DWI_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$DWI_D0,volumes_data[volumes_data$recan=="No",]$DWI_D1)
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(DWI_recan_matrix,DWI_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(DWI_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(DWI_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay
BD_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$TSA_D0_man,volumes_data[volumes_data$recan=="Yes",]$TSA_D1_man)
BD_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$TSA_D0_man,volumes_data[volumes_data$recan=="No",]$TSA_D1_man)
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(BD_recan_matrix,BD_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
matplot(x=c(1,2),y=t(BD_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(BD_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
Tmax_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$Tmax_D0_man,volumes_data[volumes_data$recan=="Yes",]$Tmax_D1_man)
Tmax_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$Tmax_D0_man,volumes_data[volumes_data$recan=="No",]$Tmax_D1_man)
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan,at=c(4,1),xlim=c(0,6),ylim=c(0,max(Tmax_recan_matrix,Tmax_nonrecan_matrix)), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(Tmax_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(Tmax_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
max(Tmax_nonrecan_matrix, Tmax_nonrecan_matrix)
max(Tmax_nonrecan_matrix, Tmax_nonrecan_matrix, na.rm = T)
# load data table with all the volumes
volumes_data <- read.csv2(file="volumes.csv", header = T, na.strings = "NaN", stringsAsFactors = F, sep = ";", dec = ".")
# remove column with subject numbers
volumes_data <- volumes_data[,c(2:18)]
# add columns for binary recanalization status + TIMI score + whether or not they had a DSC scan as well
volumes_data$recan <- c("No", "No", "No", "Yes", "No", "No", "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", "No")
volumes_data$TIMI <- c(0, 0, 0, 2, 0, 0, 3, 1, 2, 0, 3, 3, 3, 0, 1)
volumes_data$DSC <- c("Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","Yes","No","No","No")
# calculate agreement (ICC) between manual + auto delineation ratios - see section below with "agreement between ..."
# BOLD delay ratios
r3 <- icc(volumes_data[,c(6,12)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r3$comparison <- "BOLD delay ratios manual vs auto"
# Tmax ratios
r6 <- icc(volumes_data[,c(9,15)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r6$comparison <- "Tmax ratios manual vs auto"
agr_list_all <- list(r3,r6)
# boxplots of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# define D0 and D1 colors
D0_col <- rgb(0,0,1,alpha = 0.3)
D1_col <- rgb(1,0,0,alpha = 0.3)
# DWI volumes BOXPLOTS
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,50), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay volumes
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,170), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,120), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Ratios. NB: the BOLD delay ratios here are ONLY for subjects who have both BD + Tmax (for comparison purposes)
boxplot(volumes_data[volumes_data$recan=="No" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, at=c(1),xlim=c(0,6),ylim=c(0,2.5), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, add=T,at=c(2), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="No",]$Tmax_ratio_man, add=T, at=c(4),xlim=c(0,6),ylim=c(0,2), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes",]$Tmax_ratio_man, add=T,at=c(5), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
# add horizontal dashed line at ratio = 1
abline(h=1.0, lty=2)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("BOLD delay","Tmax"), cex.axis=1.5)
# add legend
legend("topright", legend = c("Non-recanalizers","Recanalizers"), fill=c("white","grey"),cex = 1.5)
title("Ratios",cex.main=1.5)
mtext(text = "D", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# PRE/POST PLOTS of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# DWI volumes PRE/POST PLOTS
DWI_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$DWI_D0,volumes_data[volumes_data$recan=="Yes",]$DWI_D1)
DWI_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$DWI_D0,volumes_data[volumes_data$recan=="No",]$DWI_D1)
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(DWI_recan_matrix,DWI_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(DWI_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(DWI_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay
BD_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$TSA_D0_man,volumes_data[volumes_data$recan=="Yes",]$TSA_D1_man)
BD_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$TSA_D0_man,volumes_data[volumes_data$recan=="No",]$TSA_D1_man)
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(BD_recan_matrix,BD_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
matplot(x=c(1,2),y=t(BD_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(BD_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
Tmax_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$Tmax_D0_man,volumes_data[volumes_data$recan=="Yes",]$Tmax_D1_man)
Tmax_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$Tmax_D0_man,volumes_data[volumes_data$recan=="No",]$Tmax_D1_man)
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan,at=c(4,1),xlim=c(0,6),ylim=c(0,max(Tmax_recan_matrix,Tmax_nonrecan_matrix, na.rm = T)), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(Tmax_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(Tmax_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# load data table with all the volumes
volumes_data <- read.csv2(file="volumes.csv", header = T, na.strings = "NaN", stringsAsFactors = F, sep = ";", dec = ".")
# remove column with subject numbers
volumes_data <- volumes_data[,c(2:18)]
# add columns for binary recanalization status + TIMI score + whether or not they had a DSC scan as well
volumes_data$recan <- c("No", "No", "No", "Yes", "No", "No", "Yes", "No", "Yes", "No", "Yes", "Yes", "Yes", "No", "No")
volumes_data$TIMI <- c(0, 0, 0, 2, 0, 0, 3, 1, 2, 0, 3, 3, 3, 0, 1)
volumes_data$DSC <- c("Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","Yes","No","No","No")
# calculate agreement (ICC) between manual + auto delineation ratios - see section below with "agreement between ..."
# BOLD delay ratios
r3 <- icc(volumes_data[,c(6,12)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r3$comparison <- "BOLD delay ratios manual vs auto"
# Tmax ratios
r6 <- icc(volumes_data[,c(9,15)], model = "twoway", type = "agreement", r0 = 0, conf.level = 0.95)
r6$comparison <- "Tmax ratios manual vs auto"
agr_list_all <- list(r3,r6)
# boxplots of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# define D0 and D1 colors
D0_col <- rgb(0,0,1,alpha = 0.3)
D1_col <- rgb(1,0,0,alpha = 0.3)
# PRE/POST PLOTS on BOXPLOTS of DWI, BOLD delay, Tmax volumes, and BOLD delay/Tmax ratios D1 vs D0 for recanalizers + non-recanalizers
par(mfrow=c(2,2), oma=c(0,2,0,0))
# DWI volumes
DWI_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$DWI_D0,volumes_data[volumes_data$recan=="Yes",]$DWI_D1)
DWI_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$DWI_D0,volumes_data[volumes_data$recan=="No",]$DWI_D1)
boxplot(volumes_data$DWI_D0~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(DWI_recan_matrix,DWI_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$DWI_D1~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(DWI_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(DWI_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("DWI",cex.main=1.5)
mtext(text = "A", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# BOLD delay
BD_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$TSA_D0_man,volumes_data[volumes_data$recan=="Yes",]$TSA_D1_man)
BD_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$TSA_D0_man,volumes_data[volumes_data$recan=="No",]$TSA_D1_man)
boxplot(volumes_data$TSA_D0_man~volumes_data$recan, at=c(4,1),xlim=c(0,6),ylim=c(0,max(BD_recan_matrix,BD_nonrecan_matrix)), xaxt='n', col=D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$TSA_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5, cex.axis=1.5,ylab="Volume (mL)", cex.lab=1.5)
matplot(x=c(1,2),y=t(BD_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(BD_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("BOLD delay",cex.main=1.5)
mtext(text = "B", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Tmax volumes
Tmax_recan_matrix <- cbind(volumes_data[volumes_data$recan=="Yes",]$Tmax_D0_man,volumes_data[volumes_data$recan=="Yes",]$Tmax_D1_man)
Tmax_nonrecan_matrix <- cbind(volumes_data[volumes_data$recan=="No",]$Tmax_D0_man,volumes_data[volumes_data$recan=="No",]$Tmax_D1_man)
boxplot(volumes_data$Tmax_D0_man~volumes_data$recan,at=c(4,1),xlim=c(0,6),ylim=c(0,max(Tmax_recan_matrix,Tmax_nonrecan_matrix, na.rm = T)), xaxt='n', col= D0_col, boxlwd=1.5, cex.axis=1.5)
boxplot(volumes_data$Tmax_D1_man~volumes_data$recan, add=T,at=c(5,2), xaxt='n', col=D1_col, boxlwd=1.5,ylab="Volume (mL)", cex.axis=1.5, cex.lab=1.5)
matplot(x=c(1,2),y=t(Tmax_recan_matrix), type= "b", pch = 19,col = "black", lty=1, xaxt="n", add=T)
matplot(x=c(4,5),y=t(Tmax_nonrecan_matrix), type= "b", pch = 19,col = "black", lty=1, add = T)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("Recanalizers","Non-recanalizers"), cex.axis=1.5)
# add legend
legend("topleft", legend = c("Day 0","Day 1"), fill=c(D0_col,D1_col),cex = 1.5)
title("Tmax",cex.main=1.5)
mtext(text = "C", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
# Ratios. NB: the BOLD delay ratios here are ONLY for subjects who have both BD + Tmax (for comparison purposes)
boxplot(volumes_data[volumes_data$recan=="No" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, at=c(1),xlim=c(0,6),ylim=c(0,2.5), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes" & volumes_data$Tmax_D0_man!="NA",]$TSA_ratio_man, add=T,at=c(2), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="No",]$Tmax_ratio_man, add=T, at=c(4),xlim=c(0,6),ylim=c(0,2), xaxt='n', boxlwd=1.5, cex.axis=1.5, boxwex=2)
boxplot(volumes_data[volumes_data$recan=="Yes",]$Tmax_ratio_man, add=T,at=c(5), xaxt='n', col="grey", boxlwd=1.5, cex.axis=1.5,ylab="D1/D0 volume ratio", cex.axis=1.5, cex.lab=1.5, boxwex=2)
# add horizontal dashed line at ratio = 1
abline(h=1.0, lty=2)
# replace x-axis labels
axis(side = 1, at=c(1.5,4.5),labels=c("BOLD delay","Tmax"), cex.axis=1.5)
# add legend
legend("topright", legend = c("Non-recanalizers","Recanalizers"), fill=c("white","grey"),cex = 1.5)
title("Ratios",cex.main=1.5)
mtext(text = "D", side = 3, line = 0.5, adj = -0.15, font = 2, cex=1.5)
hm_recan <- c()
hm_recan <- data.frame()
open(hm_recan)
load(hm_recan)
view(hm_recan)
View(hm_recan)
View(hm_recan)
read.excel <- function(header=TRUE,...) {
read.table("clipboard",sep="\t",header=header,...)
}
dat=read.excel()
read.excel()
hm_can_status <- read.excel()
hm_can_status
matplot(hm_can_status)
matplot(t(hm_can_status))
par(mfrow=c(1,1))
boxplot(hm_can_status$D0~hm_can_status$Recan.)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2))
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2), xlim=c(0,5))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(4,5))
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2), xlim=c(0,5))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(4,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(4,5), xlim=c(0,5))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(1,2), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2), xlim=c(0,5), ylim=c(0,0.6))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(4,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2), xlim=c(0,6), ylim=c(0,0.6))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(4,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,2), xlim=c(0,6), ylim=c(0,0.4))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(4,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4))
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE, col = "grey")
median(hm_can_status[hm_can_status$Recan.=="Yes",])
median(hm_can_status[hm_can_status$Recan.=="Yes",hm_can_status$D0])
hm_can_status[hm_can_status$Recan.=="Yes",hm_can_status$D0]
hm_can_status[hm_can_status$Recan.=="Yes"]$D0
hm_can_status[hm_can_status$Recan.=="Y"]$D0
hm_can_status[hm_can_status$Recan.=="Y",]
hm_can_status[hm_can_status$Recan.=="Y",hm_can_status$D0]
hm_can_status[hm_can_status$Recan.=="Y",D0]
hm_can_status[hm_can_status$Recan.=="Y",1]
median(hm_can_status[hm_can_status$Recan.=="Y",1])
median(hm_can_status[hm_can_status$Recan.=="N",1])
median(hm_can_status[hm_can_status$Recan.=="Y",2])
median(hm_can_status[hm_can_status$Recan.=="N",2])
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE, col = "grey")
axis(side=1, at=c(1.5,4.5), labels=c("Non-recanalizers","Recanalizers"),cex.axis=1.5)
legend("bottomright", legend = c("Day 0","Day 1"), fill = c("white","grey"),cex=1.5)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n", ylab="FD (mm)")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE, col = "grey")
legend("bottomright", legend = c("Day 0","Day 1"), fill = c("white","grey"),cex=1.5)
axis(side=1, at=c(1.5,4.5), labels=c("Non-recanalizers","Recanalizers"),cex.axis=1.5)
par(reset=T)
dev.off()
par(no.readonly=TRUE)
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n", ylab="FD (mm)")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE, col = "grey")
boxplot(hm_can_status$D0~hm_can_status$Recan., at = c(1,4), xlim=c(0,6), ylim=c(0,0.4), xaxt="n", ylab="FD (mm)")
boxplot(hm_can_status$D1~hm_can_status$Recan., at = c(2,5), add=TRUE, col = "grey", xaxt="n")
axis(side=1, at=c(1.5,4.5), labels=c("Non-recanalizers","Recanalizers"),cex.axis=1.5)
legend("bottomright", legend = c("Day 0","Day 1"), fill = c("white","grey"),cex=1.5)
