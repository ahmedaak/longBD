# this script plots  kernel densities for perfusion values on D0 + D1 from longitudinal BOLD delay cohort (Rev #1 Stroke, April - June 2017)
# load data
# NB: all these are outputted by my MATLAB scripts used for plotting histograms of values - each has 4 columns:
# Nonrecan D0 : Nonrecan D1 : Recan D0 : Recan D1
rm(list = ls())

library(R.matlab)
library(ggplot2)
library(gridExtra)

BD_VS_nonegs_all <- readMat("allvars_BOLD_delay_nonegs.mat")
BD_VS_nonegs_DSC <- readMat("allvars_BOLD_delay_nonegs_subswithDSC.mat")
BD_VS_nonegs_noDWI <- readMat("allvars_BD_nonegs_sansDWI.mat")

BD_HH_nonegs_all <- readMat("allvars_BOLD_delay_nonegs_HH.mat")
BD_HH_nonegs_DSC <- readMat("allvars_BOLD_delay_nonegs_subswithDSC_HH.mat")
BD_HH_nonegs_noDWI <- readMat("allvars_BD_nonegs_HH_sansDWI.mat")

Tmax <- readMat("allvars_Tmax.mat")
TTP  <- readMat("allvars_TTP.mat")

perfusion_list <- c("BD_VS_nonegs_all", "BD_HH_nonegs_all", "BD_VS_nonegs_DSC","BD_HH_nonegs_DSC", "Tmax", "TTP", "BD_VS_nonegs_noDWI",  "BD_HH_nonegs_noDWI")

BD_allrois <- c("allvars_Tmaxnonrecan_different_ROIs","allvars_Tmaxrecan_different_ROIs","allvars_TTPnonrecan_different_ROIs","allvars_TTPrecan_different_ROIs","allvars_VSnonrecan_different_ROIs", "allvars_VSrecan_different_ROIs", "allvars_HHnonrecan_different_ROIs", "allvars_HHrecan_different_ROIs") # 2 different reference signals

BD_meanvals <- c("meanBDvals_Tmaxnonrecan_different_ROIs", "meanBDvals_Tmaxrecan_different_ROIs","meanBDvals_TTPnonrecan_different_ROIs", "meanBDvals_TTPrecan_different_ROIs","meanBDvals_VSnonrecan_different_ROIs", "meanBDvals_HHnonrecan_different_ROIs", "meanBDvals_VSrecan_different_ROIs", "meanBDvals_HHrecan_different_ROIs") # 2 different reference signals